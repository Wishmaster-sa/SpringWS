# Проект на Spring Framework з підтримкою системи Трембіта

## Опис
Цей проект представляє собою веб-сервіс, розроблений з використанням фрейморка Spring. Spring - це сучасний, швидкий (високопродуктивний) фреймворк на основі Java. 
Проект демонструє роботу:
- Cтандартних асинхронних так і сінхронних викликів.
- Можливість працювати з БД PostgreSQL (функціі додавання, пошук, оновлення та видалення персони)
- Багаторівневе логування запитів
- Робота з файлом налаштувань
- Створення опису роботи API за допомогою Swagger
- Проект підтримує систему Трембіта (логування заголовків).

## Вимоги
- Java 17+
- Git (для клонування репозиторію)
- PostgreSQL 14.12
- Ubuntu Server 22.04

## Встановлення

### Встановлення за допомогою скрипта install_SpringWS.sh

Було додано скрипт `install_SpringWS.sh` для автоматизації процесу встановлення. Скрипт виконує наступні кроки:
1. Встановлює системні залежності.
2. Клонує репозиторій.
3. Встановлює або оновлює Java 21.
4. Встановлютє та налаштовує базу даних PostgreSQL 14.12.
5. Завантажує та налаштовує среду розробки Apache NetBeans 19.
6. Створює `systemd` сервіс для запуску застосунку.

#### Використання скрипта install_SpringWS.sh

1. Завантажте скрипт `install_SpringWS.sh` в папку Documents на вашому Ubuntu 22.04
2. Зробіть файл виконуваним:

   ```bash
   sudo chmod +x install_SpringWS.sh
   ```

3. Запустіть скрипт:

   ```bash
   sudo bash ./install_SpringWS.sh
   ```
4. Дайте відповідь на запитання скрипту щодо імені бази даних яка буде використовуватись для проекта, користувача бази даних, пароля користувача БД. (Скрипт сам створить БД, створить роль та встановить вказаний вами пароль.)

5. В залежності від стану оновленя вашої системи - периодично скрипт буде зупинятися щоб спитати чи треба перезавантажити деякі сервіси. Просто тиснить Enter.

6. Після того як виконання скрипту буде завершено, запустить середовище розробки Apache NetBeans, за виконайте індексування репозіторію Maven. Для цього:
  - 6.1. В середовище Apache NetBeans натиснить меню Tools->Options
  - 6.2. У вікні що відкрилося натиснить пункт Java
  - 6.3. У панелі вкладок нище перейдить на вкладку Maven 
  - 6.4. Виберить пункт Index в меню ліворуч.
  - 6.5. Після чого натиснить кнопку Index Now
  - 6.6. Очікуйте поки індексування репозіторію буде завершено, після чого можно відкривати проект.

### Ручне встановлення

#### Оновлення списку доступних пакетів програмного забезпечення з офіційних репозиторіїв 

```bash
sudo apt update
```

#### Встановлення Java JDK 21

```bash
sudo apt install openjdk-21-jdk 
```

#### Створення БД. Цей сервіс використовує PostgreSQL. Створіть базу даних та користувача на сервері СКБД.

```bash
sudo apt install postgresql postgresql-contrib
```

#### Налашування бази даних Postgres SQL

```bash
sudo -i -u postgres psql
```
CREATE DATABASE ІМ'Я_БД;

CREATE ROLE ІМ'Я_КОРИСТУВАЧА LOGIN PASSWORD 'ПАРОЛЬ_БД';

GRANT ALL PRIVILEGES ON DATABASE ІМ'Я_БД TO ІМ'Я_КОРИСТУВАЧА;

Для вихіда з командного рядку psql введіть \q

#### Завантажити та встановити середовище розробки Apache NetBeans ви можете через браузер, або через додаток Ubuntu Software

#### Завантажити Github кліент

```bash
sudo apt install git
```
#### Отримаємо та запам'ятаємо ім'я поточного користувача

```bash
whoami
```
#### Клонування репозиторію

```bash
git clone https://github.com/Wishmaster-sa/SpringWS.git

sudo mv ./SpringWS/maven ./SpringWS/.mvn

cd SpringWS
```
```bash
sudo bash mvnw -N wrapper:wrapper
```


## Подальші дії: Запустить середовище розробки Apache NetBeans, за виконайте індексування репозіторію Maven. Для цього:
   
   1. В середовище Apache NetBeans натиснить меню Tools->Options
   2. У вікні що відкрилося натиснить пункт Java
   3. У панелі вкладок нище перейдить на вкладку Maven 
   4. Виберить пункт Index в меню ліворуч.
   5. Після чого натиснить кнопку Index Now
   6. Очікуйте поки індексування репозіторію буде завершено, після чого можно відкривати проект.


### Запуск сервера


```bash
java -jar ./target/SpringWS-0.0.1-SNAPSHOT.jar
```
http://localhost:8080/

Тут `SpringWS-0.0.1-SNAPSHOT.jar` - це ім'я файлу що скомпілювався. Відкрийте браузер і перейдіть за адресою http://[адреса серверу]:8080.


## Документація

Після запуску сервера ви можете отримати доступ до автоматичної документації API за наступними адресами:

- Doc: http://[адреса серверу]:8080/
- Swagger UI: http://[адреса серверу]:8080/swagger-ui/index.html

## Наповнення бази фейковими даними
Для цілей швидкого розгортання та використання сервісу ми додаємо Python-скріпт який дозволяє швидко сгенерувати
необхідну кількість персон в БД.
   ```python
   python fill_fakerdb.py 100
   ```
де 100 - кількість персон яка буде сгенерована та додана в БД. Звістно ви можете встановити свою необхідну кількість яку ви бажаєте додати до БД.

## Налаштування як сервіса

Було додано скрипт `springws-service.sh` для автоматизації процесу встановленя веб-додатка як сервіса, та його видалення та очищення системи.

### Використання скрипта springws-service.sh
1. Скомпілюйте та отримайте jar-файл веб-сервіса через середовище розробки.
   Ви повинни отримати в папці SpringWS/target/SpringWS-0.0.1-SNAPSHOT.jar скомпільований jar-файл 

2. Зробіть скріпт виконуваним:

   ```bash
   chmod +x springws-service.sh
   ```

3. Запустіть скрипт з каталогу SpringWS:

   ```bash
   ./springws-service.sh install
   ```

Скрипт автоматично вcтановить скомпільований jar як системний сервіс.

Якщо ви бажаете видалити jar як системний сервіс, то виконайте команду
   ```bash
   ./springws-service.sh remove
   ```
Скрипт автоматично зупинить та видалить системний сервіс та системні залежності.

Запустити сервіс
   ```bash
   ./springws-service.sh start
   ```
Припинити сервіс
   ```bash
   ./springws-service.sh stop
   ```
Якщо ви виконаєте файл без аргументів командной строки, то вам буде запропоновано меню з наступними опіями:
1) Встановити сервіс
2) Запустити сервіс
3) Припинити сервіс
4) Видалити сервіс
5) Вихід

## Ліцензія

Цей проект ліцензується відповідно до умов MIT License.
